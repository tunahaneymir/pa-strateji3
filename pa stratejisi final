# ================================================================
# ðŸ“˜ PA + RL TRADING SYSTEM â€“ 2025 FINAL SPEC
# ================================================================
# YapÄ±: 3 Agent (CoinSelection, RLTradingBot, RiskMoneyMgmt)
# ---------------------------------------------------------------
# 1â€“3 â†’ Price Action (Trend-Zone-Entry)
# 4â€“6 â†’ Reinforcement Learning (Ã–ÄŸrenme ve DavranÄ±ÅŸ)
# 7 â†’ Emotional Control (Anti-Revenge, Anti-FOMO)
# 8 â†’ Learning & Integration (Continuous Loop)
# 9 â†’ System Resilience & Monitoring Layer (Kurtarma + Ä°zleme)
# ================================================================

# ðŸ§© PARÃ‡A 1 â€“ Trend & Zone Detection
part_1_trend_zone:
  purpose: "Piyasa yÃ¶nÃ¼nÃ¼ ve iÅŸlem bÃ¶lgelerini belirlemek"
  scope: "Price Action analiz motoru"
  architecture: ["CoinSelection", "RLTradingBot", "RiskMoneyMgmt"]
  trend_detection:
    method: ["EMA20", "EMA50"]
    timeframe: "4H"
    filter: {sideways: "ATR & EMA mesafe", range_pct: true}
  zone_detection:
    methods: ["ZigZag++", "Swing High/Low"]
    timeframes: ["4H", "1H", "15M"]
    zone_quality: "0â€“10 arasÄ±"
    criteria: ["merge", "overlap", "touch_count"]
    rl_adaptation: "thresholds coin bazlÄ± optimize edilir"
  execution_flow: "Trend â†’ Zone â†’ Filter â†’ Entry HazÄ±rlÄ±ÄŸÄ±"

# ðŸ§© PARÃ‡A 2 â€“ Entry & Exit System
part_2_entry_exit:
  purpose: "DoÄŸru zamanda doÄŸru seviyeden giriÅŸ-Ã§Ä±kÄ±ÅŸ"
  scope: "15M mikro PA"
  entry_system:
    multi_timeframe_sync: ["4H", "1H", "15M"]
  choch_detection:
    definition: "Change of Character"
    signal: ["long_break", "short_break"]
  fibonacci_retracement:
    levels: [0.705, 0.618]
  stop_loss:
    buffer: "swing wick + 0.5%"
  take_profit:
    structure: {TP1: "50%", TP2: "30%", TP3: "20%"}
  trailing_stop: "ChoCH exit + dinamik SL"

# ðŸ§© PARÃ‡A 3 â€“ Re-entry, Adaptive Parameters & Liquidity
part_3_reentry_adaptive:
  purpose: "Stop sonrasÄ± yeniden giriÅŸ ve adaptif parametre ayarÄ±"
  re_entry:
    rules: ["ChoCH + yeni Fib + 2 mum bekleme", "risk yarÄ±ya indirme"]
  adaptive_parameters:
    base: ["ATR", "timeframe"]
    optimize: ["ZigZag", "Swing"]
  liquidity_detection:
    logic: ["wick sweep", "stop cluster temizliÄŸi"]
  zone_memory:
    tracking: ["zone geÃ§miÅŸ performansÄ±", "blacklist", "confidence_score"]

# ðŸ§© PARÃ‡A 4 â€“ RL Architecture & Setup Scoring
part_4_rl_architecture:
  purpose: "RL motorunun karar yapÄ±sÄ± ve setup puanlamasÄ±"
  rl_architecture:
    algo: "PPO (Proximal Policy Optimization)"
    state_features: 40
    action_space: 4
    reward_function: "DavranÄ±ÅŸ + sonuÃ§ bazlÄ±"
  setup_quality_scoring:
    components: ["Zone", "ChoCH", "Volume", "Fibonacci", "Market", "Timing"]
    range: "0â€“100"
  gate_system:
    gates:
      G1: "PA kontrol"
      G2: "Setup score â‰¥ 40"
      G3: "Risk limitleri"
      G4: "Psikolojik filtreler"

# ðŸ§© PARÃ‡A 5 â€“ Risk Management & Correlation Control
part_5_risk_management:
  purpose: "Sermaye korumasÄ± ve korelasyon yÃ¶netimi"
  position_sizing:
    formula: "Risk% = (Risk_Amount / Balance)"
  adaptive_multipliers:
    factors: ["Setup quality", "Win rate", "Streak", "Volatility", "Drawdown"]
  risk_limits:
    limits: {per_trade: "2%", daily: "6%", portfolio: "10%"}
  correlation_control:
    matrix: ["BTC", "ETH", "SOL"]
    adjustment: "Risk azaltma katsayÄ±sÄ± korelasyon bazlÄ±"

# ðŸ§© PARÃ‡A 6 â€“ Reward System & Anti-FOMO
part_6_reward_anti_fomo:
  purpose: "Bot davranÄ±ÅŸlarÄ±nÄ± Ã¶dÃ¼l-ceza sistemiyle dÃ¼zenlemek"
  reward_system:
    good_decision: "+reward"
    bad_decision: "-penalty"
    range: [-200, +200]
  bonuses_penalties:
    bonus: ["sabÄ±r", "doÄŸru SL", "kademeli TP"]
    penalty: ["FOMO", "revenge", "overtrading"]
  anti_fomo_system:
    rules: ["setup eksikliÄŸi", "fiyat kovalamak", "fib yok", "hÄ±zlÄ± giriÅŸ", "vol spike", "sosyal FOMO"]
    detection: "FOMO â‰¥ 50 â†’ trade engellenir"

# ðŸ§© PARÃ‡A 7 â€“ Anti-Revenge & Overtrading System
part_7_anti_revenge:
  purpose: "Duygusal ticareti ve aÅŸÄ±rÄ± iÅŸlemleri engellemek"
  anti_revenge_system:
    cooldown: "Loss sonrasÄ± 15mâ€“2h"
    revenge_detection: "Yeni trade bloklanÄ±r"
  anti_overtrading_system:
    limits: ["Saatlik trade sÄ±nÄ±rÄ±", "Kalite dÃ¼ÅŸÃ¼ÅŸÃ¼", "Churning tespiti"]
  emotional_state_simulation:
    variables: ["Confidence", "Stress", "Patience"]
    risk_adjustment: "Duygusal durum bazlÄ± risk azalÄ±ÅŸÄ±"

# ðŸ§© PARÃ‡A 8 â€“ Learning & Integration
part_8_learning_loop:
  purpose: "TÃ¼m sistemi Ã¶ÄŸrenen dÃ¶ngÃ¼de birleÅŸtirmek"
  continuous_learning_loop:
    stages: ["data", "training", "analysis", "optimization"]
  performance_tracking:
    metrics: ["daily win_rate", "avg_rr", "sharpe", "dd"]
  adaptive_threshold_learning:
    logic: "win rateâ€™e gÃ¶re threshold auto-update"
  full_system_architecture:
    flow: "CoinSelection â†’ RLTradingBot â†’ RiskManager â†’ loop"
  learning_phases:
    phase_1: "0â€“3 ay â†’ Ã–ÄŸrenme"
    phase_2: "3â€“6 ay â†’ Optimize"
    phase_3: "6â€“12 ay â†’ UstalaÅŸma"
    phase_4: "12+ â†’ Ã–zerklik"

# ðŸ§© PARÃ‡A 9 â€“ System Resilience & Monitoring Layer (FINAL)
part_9_system_resilience:
  purpose: "Elektrik/internet kesintisi, veri kaybÄ± ve insan hatasÄ±na karÅŸÄ± koruma"
  autosave:
    time_based: "15m checkpoint"
    event_based: ["trade_open", "trade_close", "tp/sl_hit", "error_detected", "new_zone"]
    smart_save: "DeÄŸiÅŸiklik varsa kaydet"
  recovery:
    on_startup: ["state_check", "integrity_validate", "load_positions", "restore_cooldowns"]
    flow: ["Normal shutdown", "Power loss recovery", "Internet reconnection"]
  safe_mode:
    triggers: {drawdown_percent: ">10%", consecutive_losses: 3}
    actions: ["risk %0.5â€™e dÃ¼ÅŸÃ¼r", "paper mode", "Telegram uyarÄ±"]
  indicator_learning_system:
    strategy: "ZigZag++ + Swing hybrid"
    phases:
      phase_1: "Dual Confirmation (0â€“3 ay)"
      phase_2: "Parallel Testing (3â€“6 ay)"
      phase_3: "Coin-Specific Adaptive (6+ ay)"
    implementation: "ZoneDetectionManager"
  monitoring_and_logging:
    database: "SQLite (data/trades.db)"
    cli_dashboard: "Rich terminal UI"
    telegram:
      notifications: ["trade_open", "trade_close", "daily_summary", "safe_mode"]
      commands: ["/durum", "/pozisyonlar", "/bugun", "/hafta", "/duraklat", "/devam", "/export"]
    log_files: "logs/bot.log (INFO+)"
  protections:
    circuit_breaker: "5 ardÄ±ÅŸÄ±k API hatasÄ± â†’ Safe mode"
    slippage_control: "Limit orders (1dk dolmazsa iptal)"
    partial_fill_guard: true
    exchange_maintenance: true
    volatility_guard: "Vol >10%/5dk â†’ trade freeze"
    delisting_check: true
    balance_sync: "Hourly"
  backups_and_reports:
    local_backup: "daily â†’ state_backup_YYYYMMDD/"
    csv_export: "exports/trades_YYYY_MM_DD.csv"
    email_reports: "removed"
    telegram_summary: "daily + weekly"
  shadow_mode:
    enabled: true
    retention: "30d"
    logic: "Parallel test new params vs live"
  health_monitor:
    interval: "30m"
    checks: ["internet", "api_latency", "exchange_status", "cpu", "memory"]
    action: ["pause_trading_on_fail", "telegram_warn"]
  summary:
    - "Event-based autosave & safe recovery"
    - "Adaptive ZigZag/Swing learning"
    - "SQLite logging + CLI dashboard + Telegram control"
    - "Circuit breaker + limit order safety"
    - "Daily backup + shadow testing + full monitoring"

# ================================================================
# âœ… END OF MAIN SPEC
# ================================================================
